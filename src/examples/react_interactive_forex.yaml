name: "react_interactive_forex_analyzer"
description: "æ™ºèƒ½äº¤äº’å¼å¤–æ±‡åˆ†æå·¥ä½œæµ - é›†æˆReActæ¨ç†é“¾"

tools:
  - name: "data_fetcher"
    server_type: "data_fetcher"
    parameters:
      api_key: "${TWELVEDATA_API_KEY}"

  - name: "technical_analyzer" 
    server_type: "technical_analyzer"
    parameters:
      openai_api_key: "${OPENAI_API_KEY}"
      openai_base_url: "${OPENAI_BASE_URL}"

  - name: "economic_calendar"
    server_type: "economic_calendar"
    parameters:
      alpha_api_key: "${ALPHA_VANTAGE_API_KEY}"

  - name: "analyzer"
    server_type: "analyzer"
    parameters:
      openai_api_key: "${OPENAI_API_KEY}"
      openai_base_url: "${OPENAI_BASE_URL}"

workflow:
  - step: "welcome_message"
    type: "print"
    config:
      message: "ğŸ¯ å¤–æ±‡æ™ºèƒ½åˆ†æç³»ç»Ÿ - ReActæ¨ç†æ¨¡å¼"

  - step: "get_user_question"
    type: "input"
    config:
      prompt: "è¯·è¾“å…¥æ‚¨çš„å¤–æ±‡åˆ†æé—®é¢˜"
      default: "åˆ†æEUR/USDçš„å½“å‰èµ°åŠ¿å’Œäº¤æ˜“æœºä¼š"
      type: "string"
    output: "user_question"

  - step: "analyze_user_query"
    tool: "analyzer"
    method: "analyze_user_query"
    inputs:
      user_query: "{{user_question}}"
    store_result_as: "query_analysis"

  - step: "react_initial_reasoning"
    tool: "analyzer"
    method: "react_reasoning"
    inputs:
      question: "{{user_question}}"
      available_tools: ["data_fetcher", "technical_analyzer", "economic_calendar"]
      context: "åŸºäºç”¨æˆ·æŸ¥è¯¢è¿›è¡Œå¤–æ±‡å¸‚åœºç»¼åˆåˆ†æ"
    store_result_as: "reasoning_plan"

  - step: "display_investigation_plan"
    type: "print"
    config:
      message: |
        ğŸ” ReActæ¨ç†è®¡åˆ’
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        ğŸ¤” ç”¨æˆ·é—®é¢˜: {{user_question}}
        ğŸ’¡ æ¨ç†æ€è·¯: {{reasoning_plan.reasoning_plan.reasoning}}
        ğŸ¯ ç›®æ ‡è´§å¸å¯¹: {{reasoning_plan.reasoning_plan.target_currency_pair}}
        ğŸ“Š è°ƒæŸ¥æ­¥éª¤:
        {{#reasoning_plan.reasoning_plan.investigation_steps}}
        â€¢ {{.}}
        {{/reasoning_plan.reasoning_plan.investigation_steps}}

  - step: "determine_currency_pair"
    type: "set_variable"
    config:
      variable: "currency_pair"
      value: "{{#reasoning_plan.reasoning_plan.target_currency_pair}}{{.}}{{/reasoning_plan.reasoning_plan.target_currency_pair}}{{^reasoning_plan.reasoning_plan.target_currency_pair}}EUR/USD{{/reasoning_plan.reasoning_plan.target_currency_pair}}"

  - step: "confirm_currency_pair"
    type: "input"
    config:
      prompt: "è¯·ç¡®è®¤åˆ†æè´§å¸å¯¹"
      default: "{{currency_pair}}"
      type: "choice"
      choices: ["EUR/USD", "GBP/USD", "USD/JPY", "AUD/USD", "USD/CHF", "USD/CAD"]
    output: "currency_pair"

  - step: "fetch_market_data"
    tool: "data_fetcher"
    method: "fetch_data"
    inputs:
      currency_pair: "{{currency_pair}}"
      data_type: "historical"
      interval: "1day"
      output_size: 50
    store_result_as: "market_data"

  - step: "technical_analysis"
    tool: "technical_analyzer"
    method: "generate_signals"
    inputs:
      data: "{{market_data}}"
      symbol: "{{currency_pair}}"
      use_ai: true
    store_result_as: "technical_data"

  - step: "economic_analysis"
    tool: "economic_calendar"
    method: "get_trading_analysis"
    inputs:
      currency_pair: "{{currency_pair}}"
      days_ahead: 3
    store_result_as: "economic_data"

  - step: "evaluate_collected_evidence"
    tool: "analyzer"
    method: "evaluate_evidence"
    inputs:
      question: "{{user_question}}"
      current_findings: "{{reasoning_plan}}"
      collected_data:
        market_data: "{{market_data}}"
        economic_data: "{{economic_data}}"
        technical_data: "{{technical_data}}"
    store_result_as: "evidence_evaluation"

  - step: "display_evidence_status"
    type: "print"
    config:
      message: |
        ğŸ“‹ è¯æ®è¯„ä¼°ç»“æœ
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        ğŸ’­ è¯„ä¼°æ€è€ƒ: {{evidence_evaluation.evaluation.reasoning}}
        âœ… è¯æ®å……è¶³: {{evidence_evaluation.evaluation.evidence_sufficient}}
        ğŸ“Š ç½®ä¿¡æ°´å¹³: {{evidence_evaluation.evaluation.confidence_level}}

  - step: "generate_comprehensive_report"
    tool: "analyzer"
    method: "generate_comprehensive_analysis"
    inputs:
      market_data: "{{market_data}}"
      economic_data: "{{economic_data}}"
      technical_data: "{{technical_data}}"
      user_query: "{{user_question}}"
      query_analysis: "{{query_analysis.query_analysis}}"
    store_result_as: "comprehensive_analysis"

  - step: "react_final_synthesis"
    tool: "analyzer"
    method: "react_final_analysis"
    inputs:
      question: "{{user_question}}"
      reasoning_steps:
        initial_plan: "{{reasoning_plan.reasoning_plan}}"
        mid_evaluation: "{{evidence_evaluation.evaluation}}"
        data_collection_summary:
          market_data_available: "{{market_data.success}}"
          economic_data_available: "{{economic_data.success}}"
          technical_data_available: "{{technical_data.success}}"
      all_collected_data:
        market_data: "{{market_data}}"
        economic_data: "{{economic_data}}"
        technical_data: "{{technical_data}}"
    store_result_as: "final_synthesis"

  - step: "display_main_analysis"
    type: "print"
    config:
      message: |
        ğŸ“ˆ AIæ·±åº¦åˆ†ææŠ¥å‘Š
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        ğŸ’¹ åˆ†æè´§å¸å¯¹: {{currency_pair}}
        ğŸ“ ç”¨æˆ·é—®é¢˜: {{user_question}}
        
        ğŸ¯ æ ¸å¿ƒç»“è®º: {{final_synthesis.final_analysis.final_conclusion}}
        ğŸ“Š ç½®ä¿¡æ°´å¹³: {{final_synthesis.final_analysis.confidence_level}}

  - step: "display_reasoning_process"
    type: "print"
    config:
      message: |
        ğŸ” æ¨ç†è¿‡ç¨‹æ€»ç»“
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        {{final_synthesis.final_analysis.reasoning_process_summary}}

  - step: "display_comprehensive_analysis"
    type: "print"
    config:
      message: "{{comprehensive_analysis.analysis}}"

  - step: "display_trading_recommendations"
    type: "print"
    config:
      message: |
        ğŸ’° å…·ä½“äº¤æ˜“å»ºè®®
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        {{#final_synthesis.final_analysis.recommendations}}
        â€¢ {{.}}
        {{/final_synthesis.final_analysis.recommendations}}

  - step: "display_supporting_evidence"
    type: "print"
    config:
      message: |
        ğŸ“Š æ•°æ®æ”¯æŒè¯æ®
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        ğŸ’¹ å½“å‰ä»·æ ¼: {{technical_data.price}}
        ğŸ“ˆ æŠ€æœ¯ä¿¡å·: {{technical_data.composite_signal.recommendation}} ({{technical_data.composite_signal.confidence}}%)
        ğŸ“… ç»æµäº‹ä»¶: {{economic_data.economic_calendar_analysis.total_events}}ä¸ª
        ğŸŒ å¸‚åœºæƒ…ç»ª: {{economic_data.market_context.overall_sentiment}}

  - step: "follow_up_question"
    type: "input"
    config:
      prompt: "æ˜¯å¦æœ‰å…¶ä»–é—®é¢˜éœ€è¦æ·±å…¥åˆ†æï¼Ÿ(è¾“å…¥é—®é¢˜æˆ–æŒ‰å›è½¦ç»“æŸ)"
      default: ""
      type: "string"
    output: "follow_up_question"

  - step: "process_follow_up_analysis"
    type: "branch"
    config:
      condition: "{{follow_up_question}} != ''"
      true_steps:
        - step: "quick_follow_up_analysis"
          tool: "analyzer"
          method: "quick_analysis"
          inputs:
            data:
              previous_analysis: "{{comprehensive_analysis}}"
              final_synthesis: "{{final_synthesis}}"
              all_data: 
                market_data: "{{market_data}}"
                economic_data: "{{economic_data}}"
                technical_data: "{{technical_data}}"
            analysis_type: "general"
          store_result_as: "follow_up_analysis"

        - step: "display_follow_up_insights"
          type: "print"
          config:
            message: |
              ğŸ” è·Ÿè¿›åˆ†æç»“æœ
              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
              {{follow_up_analysis.analysis}}

  - step: "completion_message"
    type: "print"
    config:
      message: |
        âœ… åˆ†æå®Œæˆæ€»ç»“
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        ğŸ¯ æ¨ç†æ­¥éª¤: {{final_synthesis.reasoning_steps_used}}æ­¥
        ğŸ“Š æ•°æ®æº: {{#final_synthesis.data_sources_used}}{{.}} {{/final_synthesis.data_sources_used}}
        
        ğŸ‘‹ æ„Ÿè°¢ä½¿ç”¨æ™ºèƒ½å¤–æ±‡åˆ†æç³»ç»Ÿï¼